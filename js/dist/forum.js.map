{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@widayn/flarum-avatar-cropper/./node_modules/croppie/croppie.js","webpack://@widayn/flarum-avatar-cropper/./src/common/components/ModalWeight.js","webpack://@widayn/flarum-avatar-cropper/./src/forum/index.js","webpack://@widayn/flarum-avatar-cropper/external root \"flarum.core.compat['common/components/Button']\"","webpack://@widayn/flarum-avatar-cropper/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@widayn/flarum-avatar-cropper/external root \"flarum.core.compat['common/extend']\"","webpack://@widayn/flarum-avatar-cropper/external root \"flarum.core.compat['forum/app']\"","webpack://@widayn/flarum-avatar-cropper/external root \"flarum.core.compat['forum/components/AvatarEditor']\"","webpack://@widayn/flarum-avatar-cropper/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@widayn/flarum-avatar-cropper/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@widayn/flarum-avatar-cropper/webpack/bootstrap","webpack://@widayn/flarum-avatar-cropper/webpack/runtime/compat get default export","webpack://@widayn/flarum-avatar-cropper/webpack/runtime/define property getters","webpack://@widayn/flarum-avatar-cropper/webpack/runtime/hasOwnProperty shorthand","webpack://@widayn/flarum-avatar-cropper/webpack/runtime/make namespace object"],"sourcesContent":["/*************************\r\n * Croppie\r\n * Copyright 2019\r\n * Foliotek\r\n * Version: 2.6.5\r\n *************************/\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(factory);\r\n    } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {\r\n        // CommonJS\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.Croppie = factory();\r\n    }\r\n}(typeof self !== 'undefined' ? self : this, function () {\r\n\r\n    /* Polyfills */\r\n    if (typeof Promise !== 'function') {\r\n        /*! promise-polyfill 3.1.0 */\r\n        !function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if(\"object\"!==typeof this)throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!==typeof a)throw new TypeError(\"not a function\");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void k(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError(\"A promise cannot be resolved with itself.\");if(a&&(\"object\"===typeof a||\"function\"===typeof a)){var c=a.then;if(\"function\"===typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled=\"function\"===typeof a?a:null,this.onRejected=\"function\"===typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=setTimeout,k=\"function\"===typeof setImmediate&&setImmediate||function(a){j(a,1)},l=Array.isArray||function(a){return\"[object Array]\"===Object.prototype.toString.call(a)};c.prototype[\"catch\"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&(\"object\"===typeof g||\"function\"===typeof g)){var h=g.then;if(\"function\"===typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&\"object\"===typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},c._setImmediateFn=function(a){k=a},\"undefined\"!==typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this);\r\n    }\r\n\r\n    if (typeof window !== 'undefined' && typeof window.CustomEvent !== \"function\") {\r\n        (function(){\r\n            function CustomEvent ( event, params ) {\r\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n                var evt = document.createEvent( 'CustomEvent' );\r\n                evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\r\n                return evt;\r\n            }\r\n            CustomEvent.prototype = window.Event.prototype;\r\n            window.CustomEvent = CustomEvent;\r\n        }());\r\n    }\r\n\r\n    if (typeof HTMLCanvasElement !== 'undefined' && !HTMLCanvasElement.prototype.toBlob) {\r\n        Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\r\n            value: function (callback, type, quality) {\r\n                var binStr = atob( this.toDataURL(type, quality).split(',')[1] ),\r\n                len = binStr.length,\r\n                arr = new Uint8Array(len);\r\n\r\n                for (var i=0; i<len; i++ ) {\r\n                    arr[i] = binStr.charCodeAt(i);\r\n                }\r\n\r\n                callback( new Blob( [arr], {type: type || 'image/png'} ) );\r\n            }\r\n        });\r\n    }\r\n    /* End Polyfills */\r\n\r\n    var cssPrefixes = ['Webkit', 'Moz', 'ms'],\r\n        emptyStyles = typeof document !== 'undefined' ? document.createElement('div').style : {},\r\n        EXIF_NORM = [1,8,3,6],\r\n        EXIF_FLIP = [2,7,4,5],\r\n        CSS_TRANS_ORG,\r\n        CSS_TRANSFORM,\r\n        CSS_USERSELECT;\r\n\r\n    function vendorPrefix(prop) {\r\n        if (prop in emptyStyles) {\r\n            return prop;\r\n        }\r\n\r\n        var capProp = prop[0].toUpperCase() + prop.slice(1),\r\n            i = cssPrefixes.length;\r\n\r\n        while (i--) {\r\n            prop = cssPrefixes[i] + capProp;\r\n            if (prop in emptyStyles) {\r\n                return prop;\r\n            }\r\n        }\r\n    }\r\n\r\n    CSS_TRANSFORM = vendorPrefix('transform');\r\n    CSS_TRANS_ORG = vendorPrefix('transformOrigin');\r\n    CSS_USERSELECT = vendorPrefix('userSelect');\r\n\r\n    function getExifOffset(ornt, rotate) {\r\n        var arr = EXIF_NORM.indexOf(ornt) > -1 ? EXIF_NORM : EXIF_FLIP,\r\n            index = arr.indexOf(ornt),\r\n            offset = (rotate / 90) % arr.length;// 180 = 2%4 = 2 shift exif by 2 indexes\r\n\r\n        return arr[(arr.length + index + (offset % arr.length)) % arr.length];\r\n    }\r\n\r\n    // Credits to : Andrew Dupont - http://andrewdupont.net/2009/08/28/deep-extending-objects-in-javascript/\r\n    function deepExtend(destination, source) {\r\n        destination = destination || {};\r\n        for (var property in source) {\r\n            if (source[property] && source[property].constructor && source[property].constructor === Object) {\r\n                destination[property] = destination[property] || {};\r\n                deepExtend(destination[property], source[property]);\r\n            } else {\r\n                destination[property] = source[property];\r\n            }\r\n        }\r\n        return destination;\r\n    }\r\n\r\n    function clone(object) {\r\n        return deepExtend({}, object);\r\n    }\r\n\r\n    function debounce(func, wait, immediate) {\r\n        var timeout;\r\n        return function () {\r\n            var context = this, args = arguments;\r\n            var later = function () {\r\n                timeout = null;\r\n                if (!immediate) func.apply(context, args);\r\n            };\r\n            var callNow = immediate && !timeout;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(later, wait);\r\n            if (callNow) func.apply(context, args);\r\n        };\r\n    }\r\n\r\n    function dispatchChange(element) {\r\n        if (\"createEvent\" in document) {\r\n            var evt = document.createEvent(\"HTMLEvents\");\r\n            evt.initEvent(\"change\", false, true);\r\n            element.dispatchEvent(evt);\r\n        }\r\n        else {\r\n            element.fireEvent(\"onchange\");\r\n        }\r\n    }\r\n\r\n    //http://jsperf.com/vanilla-css\r\n    function css(el, styles, val) {\r\n        if (typeof (styles) === 'string') {\r\n            var tmp = styles;\r\n            styles = {};\r\n            styles[tmp] = val;\r\n        }\r\n\r\n        for (var prop in styles) {\r\n            el.style[prop] = styles[prop];\r\n        }\r\n    }\r\n\r\n    function addClass(el, c) {\r\n        if (el.classList) {\r\n            el.classList.add(c);\r\n        }\r\n        else {\r\n            el.className += ' ' + c;\r\n        }\r\n    }\r\n\r\n    function removeClass(el, c) {\r\n        if (el.classList) {\r\n            el.classList.remove(c);\r\n        }\r\n        else {\r\n            el.className = el.className.replace(c, '');\r\n        }\r\n    }\r\n\r\n    function setAttributes(el, attrs) {\r\n        for (var key in attrs) {\r\n            el.setAttribute(key, attrs[key]);\r\n        }\r\n    }\r\n\r\n    function num(v) {\r\n        return parseInt(v, 10);\r\n    }\r\n\r\n    /* Utilities */\r\n    function loadImage(src, doExif) {\r\n        if (!src) { throw 'Source image missing'; }\r\n        \r\n        var img = new Image();\r\n        img.style.opacity = '0';\r\n        return new Promise(function (resolve, reject) {\r\n            function _resolve() {\r\n                img.style.opacity = '1';\r\n                setTimeout(function () {\r\n                    resolve(img);\r\n                }, 1);\r\n            }\r\n\r\n            img.removeAttribute('crossOrigin');\r\n            if (src.match(/^https?:\\/\\/|^\\/\\//)) {\r\n                img.setAttribute('crossOrigin', 'anonymous');\r\n            }\r\n\r\n            img.onload = function () {\r\n                if (doExif) {\r\n                    EXIF.getData(img, function () {\r\n                        _resolve();\r\n                    });\r\n                }\r\n                else {\r\n                    _resolve();\r\n                }\r\n            };\r\n            img.onerror = function (ev) {\r\n                img.style.opacity = 1;\r\n                setTimeout(function () {\r\n                    reject(ev);\r\n                }, 1);\r\n            };\r\n            img.src = src;\r\n        });\r\n    }\r\n\r\n    function naturalImageDimensions(img, ornt) {\r\n        var w = img.naturalWidth;\r\n        var h = img.naturalHeight;\r\n        var orient = ornt || getExifOrientation(img);\r\n        if (orient && orient >= 5) {\r\n            var x= w;\r\n            w = h;\r\n            h = x;\r\n        }\r\n        return { width: w, height: h };\r\n    }\r\n\r\n    /* CSS Transform Prototype */\r\n    var TRANSLATE_OPTS = {\r\n        'translate3d': {\r\n            suffix: ', 0px'\r\n        },\r\n        'translate': {\r\n            suffix: ''\r\n        }\r\n    };\r\n    var Transform = function (x, y, scale) {\r\n        this.x = parseFloat(x);\r\n        this.y = parseFloat(y);\r\n        this.scale = parseFloat(scale);\r\n    };\r\n\r\n    Transform.parse = function (v) {\r\n        if (v.style) {\r\n            return Transform.parse(v.style[CSS_TRANSFORM]);\r\n        }\r\n        else if (v.indexOf('matrix') > -1 || v.indexOf('none') > -1) {\r\n            return Transform.fromMatrix(v);\r\n        }\r\n        else {\r\n            return Transform.fromString(v);\r\n        }\r\n    };\r\n\r\n    Transform.fromMatrix = function (v) {\r\n        var vals = v.substring(7).split(',');\r\n        if (!vals.length || v === 'none') {\r\n            vals = [1, 0, 0, 1, 0, 0];\r\n        }\r\n\r\n        return new Transform(num(vals[4]), num(vals[5]), parseFloat(vals[0]));\r\n    };\r\n\r\n    Transform.fromString = function (v) {\r\n        var values = v.split(') '),\r\n            translate = values[0].substring(Croppie.globals.translate.length + 1).split(','),\r\n            scale = values.length > 1 ? values[1].substring(6) : 1,\r\n            x = translate.length > 1 ? translate[0] : 0,\r\n            y = translate.length > 1 ? translate[1] : 0;\r\n\r\n        return new Transform(x, y, scale);\r\n    };\r\n\r\n    Transform.prototype.toString = function () {\r\n        var suffix = TRANSLATE_OPTS[Croppie.globals.translate].suffix || '';\r\n        return Croppie.globals.translate + '(' + this.x + 'px, ' + this.y + 'px' + suffix + ') scale(' + this.scale + ')';\r\n    };\r\n\r\n    var TransformOrigin = function (el) {\r\n        if (!el || !el.style[CSS_TRANS_ORG]) {\r\n            this.x = 0;\r\n            this.y = 0;\r\n            return;\r\n        }\r\n        var css = el.style[CSS_TRANS_ORG].split(' ');\r\n        this.x = parseFloat(css[0]);\r\n        this.y = parseFloat(css[1]);\r\n    };\r\n\r\n    TransformOrigin.prototype.toString = function () {\r\n        return this.x + 'px ' + this.y + 'px';\r\n    };\r\n\r\n    function getExifOrientation (img) {\r\n        return img.exifdata && img.exifdata.Orientation ? num(img.exifdata.Orientation) : 1;\r\n    }\r\n\r\n    function drawCanvas(canvas, img, orientation) {\r\n        var width = img.width,\r\n            height = img.height,\r\n            ctx = canvas.getContext('2d');\r\n\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        ctx.save();\r\n        switch (orientation) {\r\n          case 2:\r\n             ctx.translate(width, 0);\r\n             ctx.scale(-1, 1);\r\n             break;\r\n\r\n          case 3:\r\n              ctx.translate(width, height);\r\n              ctx.rotate(180*Math.PI/180);\r\n              break;\r\n\r\n          case 4:\r\n              ctx.translate(0, height);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 5:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(90*Math.PI/180);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 6:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(90*Math.PI/180);\r\n              ctx.translate(0, -height);\r\n              break;\r\n\r\n          case 7:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(-90*Math.PI/180);\r\n              ctx.translate(-width, height);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 8:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.translate(0, width);\r\n              ctx.rotate(-90*Math.PI/180);\r\n              break;\r\n        }\r\n        ctx.drawImage(img, 0,0, width, height);\r\n        ctx.restore();\r\n    }\r\n\r\n    /* Private Methods */\r\n    function _create() {\r\n        var self = this,\r\n            contClass = 'croppie-container',\r\n            customViewportClass = self.options.viewport.type ? 'cr-vp-' + self.options.viewport.type : null,\r\n            boundary, img, viewport, overlay, bw, bh;\r\n\r\n        self.options.useCanvas = self.options.enableOrientation || _hasExif.call(self);\r\n        // Properties on class\r\n        self.data = {};\r\n        self.elements = {};\r\n\r\n        boundary = self.elements.boundary = document.createElement('div');\r\n        viewport = self.elements.viewport = document.createElement('div');\r\n        img = self.elements.img = document.createElement('img');\r\n        overlay = self.elements.overlay = document.createElement('div');\r\n\r\n        if (self.options.useCanvas) {\r\n            self.elements.canvas = document.createElement('canvas');\r\n            self.elements.preview = self.elements.canvas;\r\n        }\r\n        else {\r\n            self.elements.preview = img;\r\n        }\r\n\r\n        addClass(boundary, 'cr-boundary');\r\n        boundary.setAttribute('aria-dropeffect', 'none');\r\n        bw = self.options.boundary.width;\r\n        bh = self.options.boundary.height;\r\n        css(boundary, {\r\n            width: (bw + (isNaN(bw) ? '' : 'px')),\r\n            height: (bh + (isNaN(bh) ? '' : 'px'))\r\n        });\r\n\r\n        addClass(viewport, 'cr-viewport');\r\n        if (customViewportClass) {\r\n            addClass(viewport, customViewportClass);\r\n        }\r\n        css(viewport, {\r\n            width: self.options.viewport.width + 'px',\r\n            height: self.options.viewport.height + 'px'\r\n        });\r\n        viewport.setAttribute('tabindex', 0);\r\n\r\n        addClass(self.elements.preview, 'cr-image');\r\n        setAttributes(self.elements.preview, { 'alt': 'preview', 'aria-grabbed': 'false' });\r\n        addClass(overlay, 'cr-overlay');\r\n\r\n        self.element.appendChild(boundary);\r\n        boundary.appendChild(self.elements.preview);\r\n        boundary.appendChild(viewport);\r\n        boundary.appendChild(overlay);\r\n\r\n        addClass(self.element, contClass);\r\n        if (self.options.customClass) {\r\n            addClass(self.element, self.options.customClass);\r\n        }\r\n\r\n        _initDraggable.call(this);\r\n\r\n        if (self.options.enableZoom) {\r\n            _initializeZoom.call(self);\r\n        }\r\n\r\n        // if (self.options.enableOrientation) {\r\n        //     _initRotationControls.call(self);\r\n        // }\r\n\r\n        if (self.options.enableResize) {\r\n            _initializeResize.call(self);\r\n        }\r\n    }\r\n\r\n    // function _initRotationControls () {\r\n    //     var self = this,\r\n    //         wrap, btnLeft, btnRight, iLeft, iRight;\r\n\r\n    //     wrap = document.createElement('div');\r\n    //     self.elements.orientationBtnLeft = btnLeft = document.createElement('button');\r\n    //     self.elements.orientationBtnRight = btnRight = document.createElement('button');\r\n\r\n    //     wrap.appendChild(btnLeft);\r\n    //     wrap.appendChild(btnRight);\r\n\r\n    //     iLeft = document.createElement('i');\r\n    //     iRight = document.createElement('i');\r\n    //     btnLeft.appendChild(iLeft);\r\n    //     btnRight.appendChild(iRight);\r\n\r\n    //     addClass(wrap, 'cr-rotate-controls');\r\n    //     addClass(btnLeft, 'cr-rotate-l');\r\n    //     addClass(btnRight, 'cr-rotate-r');\r\n\r\n    //     self.elements.boundary.appendChild(wrap);\r\n\r\n    //     btnLeft.addEventListener('click', function () {\r\n    //         self.rotate(-90);\r\n    //     });\r\n    //     btnRight.addEventListener('click', function () {\r\n    //         self.rotate(90);\r\n    //     });\r\n    // }\r\n\r\n    function _hasExif() {\r\n        return this.options.enableExif && window.EXIF;\r\n    }\r\n\r\n    function _initializeResize () {\r\n        var self = this;\r\n        var wrap = document.createElement('div');\r\n        var isDragging = false;\r\n        var direction;\r\n        var originalX;\r\n        var originalY;\r\n        var minSize = 50;\r\n        var maxWidth;\r\n        var maxHeight;\r\n        var vr;\r\n        var hr;\r\n\r\n        addClass(wrap, 'cr-resizer');\r\n        css(wrap, {\r\n            width: this.options.viewport.width + 'px',\r\n            height: this.options.viewport.height + 'px'\r\n        });\r\n\r\n        if (this.options.resizeControls.height) {\r\n            vr = document.createElement('div');\r\n            addClass(vr, 'cr-resizer-vertical');\r\n            wrap.appendChild(vr);\r\n        }\r\n\r\n        if (this.options.resizeControls.width) {\r\n            hr = document.createElement('div');\r\n            addClass(hr, 'cr-resizer-horisontal');\r\n            wrap.appendChild(hr);\r\n        }\r\n\r\n        function mouseDown(ev) {\r\n            if (ev.button !== undefined && ev.button !== 0) return;\r\n\r\n            ev.preventDefault();\r\n            if (isDragging) {\r\n                return;\r\n            }\r\n\r\n            var overlayRect = self.elements.overlay.getBoundingClientRect();\r\n\r\n            isDragging = true;\r\n            originalX = ev.pageX;\r\n            originalY = ev.pageY;\r\n            direction = ev.currentTarget.className.indexOf('vertical') !== -1 ? 'v' : 'h';\r\n            maxWidth = overlayRect.width;\r\n            maxHeight = overlayRect.height;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                originalX = touches.pageX;\r\n                originalY = touches.pageY;\r\n            }\r\n\r\n            window.addEventListener('mousemove', mouseMove);\r\n            window.addEventListener('touchmove', mouseMove);\r\n            window.addEventListener('mouseup', mouseUp);\r\n            window.addEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = 'none';\r\n        }\r\n\r\n        function mouseMove(ev) {\r\n            var pageX = ev.pageX;\r\n            var pageY = ev.pageY;\r\n\r\n            ev.preventDefault();\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                pageX = touches.pageX;\r\n                pageY = touches.pageY;\r\n            }\r\n\r\n            var deltaX = pageX - originalX;\r\n            var deltaY = pageY - originalY;\r\n            var newHeight = self.options.viewport.height + deltaY;\r\n            var newWidth = self.options.viewport.width + deltaX;\r\n\r\n            if (direction === 'v' && newHeight >= minSize && newHeight <= maxHeight) {\r\n                css(wrap, {\r\n                    height: newHeight + 'px'\r\n                });\r\n\r\n                self.options.boundary.height += deltaY;\r\n                css(self.elements.boundary, {\r\n                    height: self.options.boundary.height + 'px'\r\n                });\r\n\r\n                self.options.viewport.height += deltaY;\r\n                css(self.elements.viewport, {\r\n                    height: self.options.viewport.height + 'px'\r\n                });\r\n            }\r\n            else if (direction === 'h' && newWidth >= minSize && newWidth <= maxWidth) {\r\n                css(wrap, {\r\n                    width: newWidth + 'px'\r\n                });\r\n\r\n                self.options.boundary.width += deltaX;\r\n                css(self.elements.boundary, {\r\n                    width: self.options.boundary.width + 'px'\r\n                });\r\n\r\n                self.options.viewport.width += deltaX;\r\n                css(self.elements.viewport, {\r\n                    width: self.options.viewport.width + 'px'\r\n                });\r\n            }\r\n\r\n            _updateOverlay.call(self);\r\n            _updateZoomLimits.call(self);\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalY = pageY;\r\n            originalX = pageX;\r\n        }\r\n\r\n        function mouseUp() {\r\n            isDragging = false;\r\n            window.removeEventListener('mousemove', mouseMove);\r\n            window.removeEventListener('touchmove', mouseMove);\r\n            window.removeEventListener('mouseup', mouseUp);\r\n            window.removeEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n        }\r\n\r\n        if (vr) {\r\n            vr.addEventListener('mousedown', mouseDown);\r\n            vr.addEventListener('touchstart', mouseDown);\r\n        }\r\n\r\n        if (hr) {\r\n            hr.addEventListener('mousedown', mouseDown);\r\n            hr.addEventListener('touchstart', mouseDown);\r\n        }\r\n\r\n        this.elements.boundary.appendChild(wrap);\r\n    }\r\n\r\n    function _setZoomerVal(v) {\r\n        if (this.options.enableZoom) {\r\n            var z = this.elements.zoomer,\r\n                val = fix(v, 4);\r\n\r\n            z.value = Math.max(parseFloat(z.min), Math.min(parseFloat(z.max), val)).toString();\r\n        }\r\n    }\r\n\r\n    function _initializeZoom() {\r\n        var self = this,\r\n            wrap = self.elements.zoomerWrap = document.createElement('div'),\r\n            zoomer = self.elements.zoomer = document.createElement('input');\r\n\r\n        addClass(wrap, 'cr-slider-wrap');\r\n        addClass(zoomer, 'cr-slider');\r\n        zoomer.type = 'range';\r\n        zoomer.step = '0.0001';\r\n        zoomer.value = '1';\r\n        zoomer.style.display = self.options.showZoomer ? '' : 'none';\r\n        zoomer.setAttribute('aria-label', 'zoom');\r\n\r\n        self.element.appendChild(wrap);\r\n        wrap.appendChild(zoomer);\r\n\r\n        self._currentZoom = 1;\r\n\r\n        function change() {\r\n            _onZoom.call(self, {\r\n                value: parseFloat(zoomer.value),\r\n                origin: new TransformOrigin(self.elements.preview),\r\n                viewportRect: self.elements.viewport.getBoundingClientRect(),\r\n                transform: Transform.parse(self.elements.preview)\r\n            });\r\n        }\r\n\r\n        function scroll(ev) {\r\n            var delta, targetZoom;\r\n\r\n            if(self.options.mouseWheelZoom === 'ctrl' && ev.ctrlKey !== true){\r\n              return 0;\r\n            } else if (ev.wheelDelta) {\r\n                delta = ev.wheelDelta / 1200; //wheelDelta min: -120 max: 120 // max x 10 x 2\r\n            } else if (ev.deltaY) {\r\n                delta = ev.deltaY / 1060; //deltaY min: -53 max: 53 // max x 10 x 2\r\n            } else if (ev.detail) {\r\n                delta = ev.detail / -60; //delta min: -3 max: 3 // max x 10 x 2\r\n            } else {\r\n                delta = 0;\r\n            }\r\n\r\n            targetZoom = self._currentZoom + (delta * self._currentZoom);\r\n\r\n            ev.preventDefault();\r\n            _setZoomerVal.call(self, targetZoom);\r\n            change.call(self);\r\n        }\r\n\r\n        self.elements.zoomer.addEventListener('input', change);// this is being fired twice on keypress\r\n        self.elements.zoomer.addEventListener('change', change);\r\n\r\n        if (self.options.mouseWheelZoom) {\r\n            self.elements.boundary.addEventListener('mousewheel', scroll);\r\n            self.elements.boundary.addEventListener('DOMMouseScroll', scroll);\r\n        }\r\n    }\r\n\r\n    function _onZoom(ui) {\r\n        var self = this,\r\n            transform = ui ? ui.transform : Transform.parse(self.elements.preview),\r\n            vpRect = ui ? ui.viewportRect : self.elements.viewport.getBoundingClientRect(),\r\n            origin = ui ? ui.origin : new TransformOrigin(self.elements.preview);\r\n\r\n        function applyCss() {\r\n            var transCss = {};\r\n            transCss[CSS_TRANSFORM] = transform.toString();\r\n            transCss[CSS_TRANS_ORG] = origin.toString();\r\n            css(self.elements.preview, transCss);\r\n        }\r\n\r\n        self._currentZoom = ui ? ui.value : self._currentZoom;\r\n        transform.scale = self._currentZoom;\r\n        self.elements.zoomer.setAttribute('aria-valuenow', self._currentZoom);\r\n        applyCss();\r\n\r\n        if (self.options.enforceBoundary) {\r\n            var boundaries = _getVirtualBoundaries.call(self, vpRect),\r\n                transBoundaries = boundaries.translate,\r\n                oBoundaries = boundaries.origin;\r\n\r\n            if (transform.x >= transBoundaries.maxX) {\r\n                origin.x = oBoundaries.minX;\r\n                transform.x = transBoundaries.maxX;\r\n            }\r\n\r\n            if (transform.x <= transBoundaries.minX) {\r\n                origin.x = oBoundaries.maxX;\r\n                transform.x = transBoundaries.minX;\r\n            }\r\n\r\n            if (transform.y >= transBoundaries.maxY) {\r\n                origin.y = oBoundaries.minY;\r\n                transform.y = transBoundaries.maxY;\r\n            }\r\n\r\n            if (transform.y <= transBoundaries.minY) {\r\n                origin.y = oBoundaries.maxY;\r\n                transform.y = transBoundaries.minY;\r\n            }\r\n        }\r\n        applyCss();\r\n        _debouncedOverlay.call(self);\r\n        _triggerUpdate.call(self);\r\n    }\r\n\r\n    function _getVirtualBoundaries(viewport) {\r\n        var self = this,\r\n            scale = self._currentZoom,\r\n            vpWidth = viewport.width,\r\n            vpHeight = viewport.height,\r\n            centerFromBoundaryX = self.elements.boundary.clientWidth / 2,\r\n            centerFromBoundaryY = self.elements.boundary.clientHeight / 2,\r\n            imgRect = self.elements.preview.getBoundingClientRect(),\r\n            curImgWidth = imgRect.width,\r\n            curImgHeight = imgRect.height,\r\n            halfWidth = vpWidth / 2,\r\n            halfHeight = vpHeight / 2;\r\n\r\n        var maxX = ((halfWidth / scale) - centerFromBoundaryX) * -1;\r\n        var minX = maxX - ((curImgWidth * (1 / scale)) - (vpWidth * (1 / scale)));\r\n\r\n        var maxY = ((halfHeight / scale) - centerFromBoundaryY) * -1;\r\n        var minY = maxY - ((curImgHeight * (1 / scale)) - (vpHeight * (1 / scale)));\r\n\r\n        var originMinX = (1 / scale) * halfWidth;\r\n        var originMaxX = (curImgWidth * (1 / scale)) - originMinX;\r\n\r\n        var originMinY = (1 / scale) * halfHeight;\r\n        var originMaxY = (curImgHeight * (1 / scale)) - originMinY;\r\n\r\n        return {\r\n            translate: {\r\n                maxX: maxX,\r\n                minX: minX,\r\n                maxY: maxY,\r\n                minY: minY\r\n            },\r\n            origin: {\r\n                maxX: originMaxX,\r\n                minX: originMinX,\r\n                maxY: originMaxY,\r\n                minY: originMinY\r\n            }\r\n        };\r\n    }\r\n\r\n    function _updateCenterPoint(rotate) {\r\n        var self = this,\r\n            scale = self._currentZoom,\r\n            data = self.elements.preview.getBoundingClientRect(),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            transform = Transform.parse(self.elements.preview.style[CSS_TRANSFORM]),\r\n            pc = new TransformOrigin(self.elements.preview),\r\n            top = (vpData.top - data.top) + (vpData.height / 2),\r\n            left = (vpData.left - data.left) + (vpData.width / 2),\r\n            center = {},\r\n            adj = {};\r\n\r\n        if (rotate) {\r\n            var cx = pc.x;\r\n            var cy = pc.y;\r\n            var tx = transform.x;\r\n            var ty = transform.y;\r\n\r\n            center.y = cx;\r\n            center.x = cy;\r\n            transform.y = tx;\r\n            transform.x = ty;\r\n        }\r\n        else {\r\n            center.y = top / scale;\r\n            center.x = left / scale;\r\n\r\n            adj.y = (center.y - pc.y) * (1 - scale);\r\n            adj.x = (center.x - pc.x) * (1 - scale);\r\n\r\n            transform.x -= adj.x;\r\n            transform.y -= adj.y;\r\n        }\r\n\r\n        var newCss = {};\r\n        newCss[CSS_TRANS_ORG] = center.x + 'px ' + center.y + 'px';\r\n        newCss[CSS_TRANSFORM] = transform.toString();\r\n        css(self.elements.preview, newCss);\r\n    }\r\n\r\n    function _initDraggable() {\r\n        var self = this,\r\n            isDragging = false,\r\n            originalX,\r\n            originalY,\r\n            originalDistance,\r\n            vpRect,\r\n            transform;\r\n\r\n        function assignTransformCoordinates(deltaX, deltaY) {\r\n            var imgRect = self.elements.preview.getBoundingClientRect(),\r\n                top = transform.y + deltaY,\r\n                left = transform.x + deltaX;\r\n\r\n            if (self.options.enforceBoundary) {\r\n                if (vpRect.top > imgRect.top + deltaY && vpRect.bottom < imgRect.bottom + deltaY) {\r\n                    transform.y = top;\r\n                }\r\n\r\n                if (vpRect.left > imgRect.left + deltaX && vpRect.right < imgRect.right + deltaX) {\r\n                    transform.x = left;\r\n                }\r\n            }\r\n            else {\r\n                transform.y = top;\r\n                transform.x = left;\r\n            }\r\n        }\r\n\r\n        function toggleGrabState(isDragging) {\r\n          self.elements.preview.setAttribute('aria-grabbed', isDragging);\r\n          self.elements.boundary.setAttribute('aria-dropeffect', isDragging? 'move': 'none');\r\n        }\r\n\r\n        function keyDown(ev) {\r\n            var LEFT_ARROW  = 37,\r\n                UP_ARROW    = 38,\r\n                RIGHT_ARROW = 39,\r\n                DOWN_ARROW  = 40;\r\n\r\n            if (ev.shiftKey && (ev.keyCode === UP_ARROW || ev.keyCode === DOWN_ARROW)) {\r\n                var zoom;\r\n                if (ev.keyCode === UP_ARROW) {\r\n                    zoom = parseFloat(self.elements.zoomer.value) + parseFloat(self.elements.zoomer.step)\r\n                }\r\n                else {\r\n                    zoom = parseFloat(self.elements.zoomer.value) - parseFloat(self.elements.zoomer.step)\r\n                }\r\n                self.setZoom(zoom);\r\n            }\r\n            else if (self.options.enableKeyMovement && (ev.keyCode >= 37 && ev.keyCode <= 40)) {\r\n                ev.preventDefault();\r\n                var movement = parseKeyDown(ev.keyCode);\r\n\r\n                transform = Transform.parse(self.elements.preview);\r\n                document.body.style[CSS_USERSELECT] = 'none';\r\n                vpRect = self.elements.viewport.getBoundingClientRect();\r\n                keyMove(movement);\r\n            }\r\n\r\n            function parseKeyDown(key) {\r\n                switch (key) {\r\n                    case LEFT_ARROW:\r\n                        return [1, 0];\r\n                    case UP_ARROW:\r\n                        return [0, 1];\r\n                    case RIGHT_ARROW:\r\n                        return [-1, 0];\r\n                    case DOWN_ARROW:\r\n                        return [0, -1];\r\n                }\r\n            }\r\n        }\r\n\r\n        function keyMove(movement) {\r\n            var deltaX = movement[0],\r\n                deltaY = movement[1],\r\n                newCss = {};\r\n\r\n            assignTransformCoordinates(deltaX, deltaY);\r\n\r\n            newCss[CSS_TRANSFORM] = transform.toString();\r\n            css(self.elements.preview, newCss);\r\n            _updateOverlay.call(self);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalDistance = 0;\r\n        }\r\n\r\n        function mouseDown(ev) {\r\n            if (ev.button !== undefined && ev.button !== 0) return;\r\n\r\n            ev.preventDefault();\r\n            if (isDragging) return;\r\n            isDragging = true;\r\n            originalX = ev.pageX;\r\n            originalY = ev.pageY;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                originalX = touches.pageX;\r\n                originalY = touches.pageY;\r\n            }\r\n            toggleGrabState(isDragging);\r\n            transform = Transform.parse(self.elements.preview);\r\n            window.addEventListener('mousemove', mouseMove);\r\n            window.addEventListener('touchmove', mouseMove);\r\n            window.addEventListener('mouseup', mouseUp);\r\n            window.addEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = 'none';\r\n            vpRect = self.elements.viewport.getBoundingClientRect();\r\n        }\r\n\r\n        function mouseMove(ev) {\r\n            ev.preventDefault();\r\n            var pageX = ev.pageX,\r\n                pageY = ev.pageY;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                pageX = touches.pageX;\r\n                pageY = touches.pageY;\r\n            }\r\n\r\n            var deltaX = pageX - originalX,\r\n                deltaY = pageY - originalY,\r\n                newCss = {};\r\n\r\n            if (ev.type === 'touchmove') {\r\n                if (ev.touches.length > 1) {\r\n                    var touch1 = ev.touches[0];\r\n                    var touch2 = ev.touches[1];\r\n                    var dist = Math.sqrt((touch1.pageX - touch2.pageX) * (touch1.pageX - touch2.pageX) + (touch1.pageY - touch2.pageY) * (touch1.pageY - touch2.pageY));\r\n\r\n                    if (!originalDistance) {\r\n                        originalDistance = dist / self._currentZoom;\r\n                    }\r\n\r\n                    var scale = dist / originalDistance;\r\n\r\n                    _setZoomerVal.call(self, scale);\r\n                    dispatchChange(self.elements.zoomer);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            assignTransformCoordinates(deltaX, deltaY);\r\n\r\n            newCss[CSS_TRANSFORM] = transform.toString();\r\n            css(self.elements.preview, newCss);\r\n            _updateOverlay.call(self);\r\n            originalY = pageY;\r\n            originalX = pageX;\r\n        }\r\n\r\n        function mouseUp() {\r\n            isDragging = false;\r\n            toggleGrabState(isDragging);\r\n            window.removeEventListener('mousemove', mouseMove);\r\n            window.removeEventListener('touchmove', mouseMove);\r\n            window.removeEventListener('mouseup', mouseUp);\r\n            window.removeEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalDistance = 0;\r\n        }\r\n\r\n        self.elements.overlay.addEventListener('mousedown', mouseDown);\r\n        self.elements.viewport.addEventListener('keydown', keyDown);\r\n        self.elements.overlay.addEventListener('touchstart', mouseDown);\r\n    }\r\n\r\n    function _updateOverlay() {\r\n        if (!this.elements) return; // since this is debounced, it can be fired after destroy\r\n        var self = this,\r\n            boundRect = self.elements.boundary.getBoundingClientRect(),\r\n            imgData = self.elements.preview.getBoundingClientRect();\r\n\r\n        css(self.elements.overlay, {\r\n            width: imgData.width + 'px',\r\n            height: imgData.height + 'px',\r\n            top: (imgData.top - boundRect.top) + 'px',\r\n            left: (imgData.left - boundRect.left) + 'px'\r\n        });\r\n    }\r\n    var _debouncedOverlay = debounce(_updateOverlay, 500);\r\n\r\n    function _triggerUpdate() {\r\n        var self = this,\r\n            data = self.get();\r\n\r\n        if (!_isVisible.call(self)) {\r\n            return;\r\n        }\r\n\r\n        self.options.update.call(self, data);\r\n        if (self.$ && typeof Prototype === 'undefined') {\r\n            self.$(self.element).trigger('update.croppie', data);\r\n        }\r\n        else {\r\n            var ev;\r\n            if (window.CustomEvent) {\r\n                ev = new CustomEvent('update', { detail: data });\r\n            } else {\r\n                ev = document.createEvent('CustomEvent');\r\n                ev.initCustomEvent('update', true, true, data);\r\n            }\r\n\r\n            self.element.dispatchEvent(ev);\r\n        }\r\n    }\r\n\r\n    function _isVisible() {\r\n        return this.elements.preview.offsetHeight > 0 && this.elements.preview.offsetWidth > 0;\r\n    }\r\n\r\n    function _updatePropertiesFromImage() {\r\n        var self = this,\r\n            initialZoom = 1,\r\n            cssReset = {},\r\n            img = self.elements.preview,\r\n            imgData,\r\n            transformReset = new Transform(0, 0, initialZoom),\r\n            originReset = new TransformOrigin(),\r\n            isVisible = _isVisible.call(self);\r\n\r\n        if (!isVisible || self.data.bound) {// if the croppie isn't visible or it doesn't need binding\r\n            return;\r\n        }\r\n\r\n        self.data.bound = true;\r\n        cssReset[CSS_TRANSFORM] = transformReset.toString();\r\n        cssReset[CSS_TRANS_ORG] = originReset.toString();\r\n        cssReset['opacity'] = 1;\r\n        css(img, cssReset);\r\n\r\n        imgData = self.elements.preview.getBoundingClientRect();\r\n\r\n        self._originalImageWidth = imgData.width;\r\n        self._originalImageHeight = imgData.height;\r\n        self.data.orientation = _hasExif.call(self) ? getExifOrientation(self.elements.img) : self.data.orientation;\r\n\r\n        if (self.options.enableZoom) {\r\n            _updateZoomLimits.call(self, true);\r\n        }\r\n        else {\r\n            self._currentZoom = initialZoom;\r\n        }\r\n\r\n        transformReset.scale = self._currentZoom;\r\n        cssReset[CSS_TRANSFORM] = transformReset.toString();\r\n        css(img, cssReset);\r\n\r\n        if (self.data.points.length) {\r\n            _bindPoints.call(self, self.data.points);\r\n        }\r\n        else {\r\n            _centerImage.call(self);\r\n        }\r\n\r\n        _updateCenterPoint.call(self);\r\n        _updateOverlay.call(self);\r\n    }\r\n\r\n    function _updateZoomLimits (initial) {\r\n        var self = this,\r\n            minZoom = Math.max(self.options.minZoom, 0) || 0,\r\n            maxZoom = self.options.maxZoom || 1.5,\r\n            initialZoom,\r\n            defaultInitialZoom,\r\n            zoomer = self.elements.zoomer,\r\n            scale = parseFloat(zoomer.value),\r\n            boundaryData = self.elements.boundary.getBoundingClientRect(),\r\n            imgData = naturalImageDimensions(self.elements.img, self.data.orientation),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            minW,\r\n            minH;\r\n        if (self.options.enforceBoundary) {\r\n            minW = vpData.width / imgData.width;\r\n            minH = vpData.height / imgData.height;\r\n            minZoom = Math.max(minW, minH);\r\n        }\r\n\r\n        if (minZoom >= maxZoom) {\r\n            maxZoom = minZoom + 1;\r\n        }\r\n\r\n        zoomer.min = fix(minZoom, 4);\r\n        zoomer.max = fix(maxZoom, 4);\r\n\r\n        if (!initial && (scale < zoomer.min || scale > zoomer.max)) {\r\n            _setZoomerVal.call(self, scale < zoomer.min ? zoomer.min : zoomer.max);\r\n        }\r\n        else if (initial) {\r\n            defaultInitialZoom = Math.max((boundaryData.width / imgData.width), (boundaryData.height / imgData.height));\r\n            initialZoom = self.data.boundZoom !== null ? self.data.boundZoom : defaultInitialZoom;\r\n            _setZoomerVal.call(self, initialZoom);\r\n        }\r\n\r\n        dispatchChange(zoomer);\r\n    }\r\n\r\n    function _bindPoints(points) {\r\n        if (points.length !== 4) {\r\n            throw \"Croppie - Invalid number of points supplied: \" + points;\r\n        }\r\n        var self = this,\r\n            pointsWidth = points[2] - points[0],\r\n            // pointsHeight = points[3] - points[1],\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            boundRect = self.elements.boundary.getBoundingClientRect(),\r\n            vpOffset = {\r\n                left: vpData.left - boundRect.left,\r\n                top: vpData.top - boundRect.top\r\n            },\r\n            scale = vpData.width / pointsWidth,\r\n            originTop = points[1],\r\n            originLeft = points[0],\r\n            transformTop = (-1 * points[1]) + vpOffset.top,\r\n            transformLeft = (-1 * points[0]) + vpOffset.left,\r\n            newCss = {};\r\n\r\n        newCss[CSS_TRANS_ORG] = originLeft + 'px ' + originTop + 'px';\r\n        newCss[CSS_TRANSFORM] = new Transform(transformLeft, transformTop, scale).toString();\r\n        css(self.elements.preview, newCss);\r\n\r\n        _setZoomerVal.call(self, scale);\r\n        self._currentZoom = scale;\r\n    }\r\n\r\n    function _centerImage() {\r\n        var self = this,\r\n            imgDim = self.elements.preview.getBoundingClientRect(),\r\n            vpDim = self.elements.viewport.getBoundingClientRect(),\r\n            boundDim = self.elements.boundary.getBoundingClientRect(),\r\n            vpLeft = vpDim.left - boundDim.left,\r\n            vpTop = vpDim.top - boundDim.top,\r\n            w = vpLeft - ((imgDim.width - vpDim.width) / 2),\r\n            h = vpTop - ((imgDim.height - vpDim.height) / 2),\r\n            transform = new Transform(w, h, self._currentZoom);\r\n\r\n        css(self.elements.preview, CSS_TRANSFORM, transform.toString());\r\n    }\r\n\r\n    function _transferImageToCanvas(customOrientation) {\r\n        var self = this,\r\n            canvas = self.elements.canvas,\r\n            img = self.elements.img,\r\n            ctx = canvas.getContext('2d');\r\n\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        var orientation = self.options.enableOrientation && customOrientation || getExifOrientation(img);\r\n        drawCanvas(canvas, img, orientation);\r\n    }\r\n\r\n    function _getCanvas(data) {\r\n        var self = this,\r\n            points = data.points,\r\n            left = num(points[0]),\r\n            top = num(points[1]),\r\n            right = num(points[2]),\r\n            bottom = num(points[3]),\r\n            width = right-left,\r\n            height = bottom-top,\r\n            circle = data.circle,\r\n            canvas = document.createElement('canvas'),\r\n            ctx = canvas.getContext('2d'),\r\n            startX = 0,\r\n            startY = 0,\r\n            canvasWidth = data.outputWidth || width,\r\n            canvasHeight = data.outputHeight || height;\r\n\r\n        canvas.width = canvasWidth;\r\n        canvas.height = canvasHeight;\r\n\r\n        if (data.backgroundColor) {\r\n            ctx.fillStyle = data.backgroundColor;\r\n            ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n\r\n        // By default assume we're going to draw the entire\r\n        // source image onto the destination canvas.\r\n        var sx = left,\r\n            sy = top,\r\n            sWidth = width,\r\n            sHeight = height,\r\n            dx = 0,\r\n            dy = 0,\r\n            dWidth = canvasWidth,\r\n            dHeight = canvasHeight;\r\n\r\n        //\r\n        // Do not go outside of the original image's bounds along the x-axis.\r\n        // Handle translations when projecting onto the destination canvas.\r\n        //\r\n\r\n        // The smallest possible source x-position is 0.\r\n        if (left < 0) {\r\n            sx = 0;\r\n            dx = (Math.abs(left) / width) * canvasWidth;\r\n        }\r\n\r\n        // The largest possible source width is the original image's width.\r\n        if (sWidth + sx > self._originalImageWidth) {\r\n            sWidth = self._originalImageWidth - sx;\r\n            dWidth =  (sWidth / width) * canvasWidth;\r\n        }\r\n\r\n        //\r\n        // Do not go outside of the original image's bounds along the y-axis.\r\n        //\r\n\r\n        // The smallest possible source y-position is 0.\r\n        if (top < 0) {\r\n            sy = 0;\r\n            dy = (Math.abs(top) / height) * canvasHeight;\r\n        }\r\n\r\n        // The largest possible source height is the original image's height.\r\n        if (sHeight + sy > self._originalImageHeight) {\r\n            sHeight = self._originalImageHeight - sy;\r\n            dHeight = (sHeight / height) * canvasHeight;\r\n        }\r\n\r\n        // console.table({ left, right, top, bottom, canvasWidth, canvasHeight, width, height, startX, startY, circle, sx, sy, dx, dy, sWidth, sHeight, dWidth, dHeight });\r\n\r\n        ctx.drawImage(this.elements.preview, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);\r\n        if (circle) {\r\n            ctx.fillStyle = '#fff';\r\n            ctx.globalCompositeOperation = 'destination-in';\r\n            ctx.beginPath();\r\n            ctx.arc(canvas.width / 2, canvas.height / 2, canvas.width / 2, 0, Math.PI * 2, true);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n        return canvas;\r\n    }\r\n\r\n    function _getHtmlResult(data) {\r\n        var points = data.points,\r\n            div = document.createElement('div'),\r\n            img = document.createElement('img'),\r\n            width = points[2] - points[0],\r\n            height = points[3] - points[1];\r\n\r\n        addClass(div, 'croppie-result');\r\n        div.appendChild(img);\r\n        css(img, {\r\n            left: (-1 * points[0]) + 'px',\r\n            top: (-1 * points[1]) + 'px'\r\n        });\r\n        img.src = data.url;\r\n        css(div, {\r\n            width: width + 'px',\r\n            height: height + 'px'\r\n        });\r\n\r\n        return div;\r\n    }\r\n\r\n    function _getBase64Result(data) {\r\n        return _getCanvas.call(this, data).toDataURL(data.format, data.quality);\r\n    }\r\n\r\n    function _getBlobResult(data) {\r\n        var self = this;\r\n        return new Promise(function (resolve) {\r\n            _getCanvas.call(self, data).toBlob(function (blob) {\r\n                resolve(blob);\r\n            }, data.format, data.quality);\r\n        });\r\n    }\r\n\r\n    function _replaceImage(img) {\r\n        if (this.elements.img.parentNode) {\r\n            Array.prototype.forEach.call(this.elements.img.classList, function(c) { img.classList.add(c); });\r\n            this.elements.img.parentNode.replaceChild(img, this.elements.img);\r\n            this.elements.preview = img; // if the img is attached to the DOM, they're not using the canvas\r\n        }\r\n        this.elements.img = img;\r\n    }\r\n\r\n    function _bind(options, cb) {\r\n        var self = this,\r\n            url,\r\n            points = [],\r\n            zoom = null,\r\n            hasExif = _hasExif.call(self);\r\n\r\n        if (typeof (options) === 'string') {\r\n            url = options;\r\n            options = {};\r\n        }\r\n        else if (Array.isArray(options)) {\r\n            points = options.slice();\r\n        }\r\n        else if (typeof (options) === 'undefined' && self.data.url) { //refreshing\r\n            _updatePropertiesFromImage.call(self);\r\n            _triggerUpdate.call(self);\r\n            return null;\r\n        }\r\n        else {\r\n            url = options.url;\r\n            points = options.points || [];\r\n            zoom = typeof(options.zoom) === 'undefined' ? null : options.zoom;\r\n        }\r\n\r\n        self.data.bound = false;\r\n        self.data.url = url || self.data.url;\r\n        self.data.boundZoom = zoom;\r\n\r\n        return loadImage(url, hasExif).then(function (img) {\r\n            _replaceImage.call(self, img);\r\n            if (!points.length) {\r\n                var natDim = naturalImageDimensions(img);\r\n                var rect = self.elements.viewport.getBoundingClientRect();\r\n                var aspectRatio = rect.width / rect.height;\r\n                var imgAspectRatio = natDim.width / natDim.height;\r\n                var width, height;\r\n\r\n                if (imgAspectRatio > aspectRatio) {\r\n                    height = natDim.height;\r\n                    width = height * aspectRatio;\r\n                }\r\n                else {\r\n                    width = natDim.width;\r\n                    height = natDim.height / aspectRatio;\r\n                }\r\n\r\n                var x0 = (natDim.width - width) / 2;\r\n                var y0 = (natDim.height - height) / 2;\r\n                var x1 = x0 + width;\r\n                var y1 = y0 + height;\r\n                self.data.points = [x0, y0, x1, y1];\r\n            }\r\n            else if (self.options.relative) {\r\n                points = [\r\n                    points[0] * img.naturalWidth / 100,\r\n                    points[1] * img.naturalHeight / 100,\r\n                    points[2] * img.naturalWidth / 100,\r\n                    points[3] * img.naturalHeight / 100\r\n                ];\r\n            }\r\n\r\n            self.data.orientation = options.orientation || 1;\r\n            self.data.points = points.map(function (p) {\r\n                return parseFloat(p);\r\n            });\r\n            if (self.options.useCanvas) {\r\n                _transferImageToCanvas.call(self, self.data.orientation);\r\n            }\r\n            _updatePropertiesFromImage.call(self);\r\n            _triggerUpdate.call(self);\r\n            cb && cb();\r\n        });\r\n    }\r\n\r\n    function fix(v, decimalPoints) {\r\n        return parseFloat(v).toFixed(decimalPoints || 0);\r\n    }\r\n\r\n    function _get() {\r\n        var self = this,\r\n            imgData = self.elements.preview.getBoundingClientRect(),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            x1 = vpData.left - imgData.left,\r\n            y1 = vpData.top - imgData.top,\r\n            widthDiff = (vpData.width - self.elements.viewport.offsetWidth) / 2, //border\r\n            heightDiff = (vpData.height - self.elements.viewport.offsetHeight) / 2,\r\n            x2 = x1 + self.elements.viewport.offsetWidth + widthDiff,\r\n            y2 = y1 + self.elements.viewport.offsetHeight + heightDiff,\r\n            scale = self._currentZoom;\r\n\r\n        if (scale === Infinity || isNaN(scale)) {\r\n            scale = 1;\r\n        }\r\n\r\n        var max = self.options.enforceBoundary ? 0 : Number.NEGATIVE_INFINITY;\r\n        x1 = Math.max(max, x1 / scale);\r\n        y1 = Math.max(max, y1 / scale);\r\n        x2 = Math.max(max, x2 / scale);\r\n        y2 = Math.max(max, y2 / scale);\r\n\r\n        return {\r\n            points: [fix(x1), fix(y1), fix(x2), fix(y2)],\r\n            zoom: scale,\r\n            orientation: self.data.orientation\r\n        };\r\n    }\r\n\r\n    var RESULT_DEFAULTS = {\r\n            type: 'canvas',\r\n            format: 'png',\r\n            quality: 1\r\n        },\r\n        RESULT_FORMATS = ['jpeg', 'webp', 'png'];\r\n\r\n    function _result(options) {\r\n        var self = this,\r\n            data = _get.call(self),\r\n            opts = deepExtend(clone(RESULT_DEFAULTS), clone(options)),\r\n            resultType = (typeof (options) === 'string' ? options : (opts.type || 'base64')),\r\n            size = opts.size || 'viewport',\r\n            format = opts.format,\r\n            quality = opts.quality,\r\n            backgroundColor = opts.backgroundColor,\r\n            circle = typeof opts.circle === 'boolean' ? opts.circle : (self.options.viewport.type === 'circle'),\r\n            vpRect = self.elements.viewport.getBoundingClientRect(),\r\n            ratio = vpRect.width / vpRect.height,\r\n            prom;\r\n\r\n        if (size === 'viewport') {\r\n            data.outputWidth = vpRect.width;\r\n            data.outputHeight = vpRect.height;\r\n        } else if (typeof size === 'object') {\r\n            if (size.width && size.height) {\r\n                data.outputWidth = size.width;\r\n                data.outputHeight = size.height;\r\n            } else if (size.width) {\r\n                data.outputWidth = size.width;\r\n                data.outputHeight = size.width / ratio;\r\n            } else if (size.height) {\r\n                data.outputWidth = size.height * ratio;\r\n                data.outputHeight = size.height;\r\n            }\r\n        }\r\n\r\n        if (RESULT_FORMATS.indexOf(format) > -1) {\r\n            data.format = 'image/' + format;\r\n            data.quality = quality;\r\n        }\r\n\r\n        data.circle = circle;\r\n        data.url = self.data.url;\r\n        data.backgroundColor = backgroundColor;\r\n\r\n        prom = new Promise(function (resolve) {\r\n            switch(resultType.toLowerCase())\r\n            {\r\n                case 'rawcanvas':\r\n                    resolve(_getCanvas.call(self, data));\r\n                    break;\r\n                case 'canvas':\r\n                case 'base64':\r\n                    resolve(_getBase64Result.call(self, data));\r\n                    break;\r\n                case 'blob':\r\n                    _getBlobResult.call(self, data).then(resolve);\r\n                    break;\r\n                default:\r\n                    resolve(_getHtmlResult.call(self, data));\r\n                    break;\r\n            }\r\n        });\r\n        return prom;\r\n    }\r\n\r\n    function _refresh() {\r\n        _updatePropertiesFromImage.call(this);\r\n    }\r\n\r\n    function _rotate(deg) {\r\n        if (!this.options.useCanvas || !this.options.enableOrientation) {\r\n            throw 'Croppie: Cannot rotate without enableOrientation && EXIF.js included';\r\n        }\r\n\r\n        var self = this,\r\n            canvas = self.elements.canvas;\r\n\r\n        self.data.orientation = getExifOffset(self.data.orientation, deg);\r\n        drawCanvas(canvas, self.elements.img, self.data.orientation);\r\n        _updateCenterPoint.call(self, true);\r\n        _updateZoomLimits.call(self);\r\n\r\n        // Reverses image dimensions if the degrees of rotation is not divisible by 180.\r\n        if ((Math.abs(deg) / 90) % 2 === 1) {\r\n            var oldHeight = self._originalImageHeight;\r\n            var oldWidth = self._originalImageWidth;\r\n            self._originalImageWidth = oldHeight;\r\n            self._originalImageHeight = oldWidth;\r\n        }\r\n    }\r\n\r\n    function _destroy() {\r\n        var self = this;\r\n        self.element.removeChild(self.elements.boundary);\r\n        removeClass(self.element, 'croppie-container');\r\n        if (self.options.enableZoom) {\r\n            self.element.removeChild(self.elements.zoomerWrap);\r\n        }\r\n        delete self.elements;\r\n    }\r\n\r\n    if (typeof window !== 'undefined' && window.jQuery) {\r\n        var $ = window.jQuery;\r\n        $.fn.croppie = function (opts) {\r\n            var ot = typeof opts;\r\n\r\n            if (ot === 'string') {\r\n                var args = Array.prototype.slice.call(arguments, 1);\r\n                var singleInst = $(this).data('croppie');\r\n\r\n                if (opts === 'get') {\r\n                    return singleInst.get();\r\n                }\r\n                else if (opts === 'result') {\r\n                    return singleInst.result.apply(singleInst, args);\r\n                }\r\n                else if (opts === 'bind') {\r\n                    return singleInst.bind.apply(singleInst, args);\r\n                }\r\n\r\n                return this.each(function () {\r\n                    var i = $(this).data('croppie');\r\n                    if (!i) return;\r\n\r\n                    var method = i[opts];\r\n                    if ($.isFunction(method)) {\r\n                        method.apply(i, args);\r\n                        if (opts === 'destroy') {\r\n                            $(this).removeData('croppie');\r\n                        }\r\n                    }\r\n                    else {\r\n                        throw 'Croppie ' + opts + ' method not found';\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                return this.each(function () {\r\n                    var i = new Croppie(this, opts);\r\n                    i.$ = $;\r\n                    $(this).data('croppie', i);\r\n                });\r\n            }\r\n        };\r\n    }\r\n\r\n    function Croppie(element, opts) {\r\n        if (element.className.indexOf('croppie-container') > -1) {\r\n            throw new Error(\"Croppie: Can't initialize croppie more than once\");\r\n        }\r\n        this.element = element;\r\n        this.options = deepExtend(clone(Croppie.defaults), opts);\r\n\r\n        if (this.element.tagName.toLowerCase() === 'img') {\r\n            var origImage = this.element;\r\n            addClass(origImage, 'cr-original-image');\r\n            setAttributes(origImage, {'aria-hidden' : 'true', 'alt' : '' });\r\n            var replacementDiv = document.createElement('div');\r\n            this.element.parentNode.appendChild(replacementDiv);\r\n            replacementDiv.appendChild(origImage);\r\n            this.element = replacementDiv;\r\n            this.options.url = this.options.url || origImage.src;\r\n        }\r\n\r\n        _create.call(this);\r\n        if (this.options.url) {\r\n            var bindOpts = {\r\n                url: this.options.url,\r\n                points: this.options.points\r\n            };\r\n            delete this.options['url'];\r\n            delete this.options['points'];\r\n            _bind.call(this, bindOpts);\r\n        }\r\n    }\r\n\r\n    Croppie.defaults = {\r\n        viewport: {\r\n            width: 100,\r\n            height: 100,\r\n            type: 'square'\r\n        },\r\n        boundary: { },\r\n        orientationControls: {\r\n            enabled: true,\r\n            leftClass: '',\r\n            rightClass: ''\r\n        },\r\n        resizeControls: {\r\n            width: true,\r\n            height: true\r\n        },\r\n        customClass: '',\r\n        showZoomer: true,\r\n        enableZoom: true,\r\n        enableResize: false,\r\n        mouseWheelZoom: true,\r\n        enableExif: false,\r\n        enforceBoundary: true,\r\n        enableOrientation: false,\r\n        enableKeyMovement: true,\r\n        update: function () { }\r\n    };\r\n\r\n    Croppie.globals = {\r\n        translate: 'translate3d'\r\n    };\r\n\r\n    deepExtend(Croppie.prototype, {\r\n        bind: function (options, cb) {\r\n            return _bind.call(this, options, cb);\r\n        },\r\n        get: function () {\r\n            var data = _get.call(this);\r\n            var points = data.points;\r\n            if (this.options.relative) {\r\n                points[0] /= this.elements.img.naturalWidth / 100;\r\n                points[1] /= this.elements.img.naturalHeight / 100;\r\n                points[2] /= this.elements.img.naturalWidth / 100;\r\n                points[3] /= this.elements.img.naturalHeight / 100;\r\n            }\r\n            return data;\r\n        },\r\n        result: function (type) {\r\n            return _result.call(this, type);\r\n        },\r\n        refresh: function () {\r\n            return _refresh.call(this);\r\n        },\r\n        setZoom: function (v) {\r\n            _setZoomerVal.call(this, v);\r\n            dispatchChange(this.elements.zoomer);\r\n        },\r\n        rotate: function (deg) {\r\n            _rotate.call(this, deg);\r\n        },\r\n        destroy: function () {\r\n            return _destroy.call(this);\r\n        }\r\n    });\r\n    return Croppie;\r\n}));\r\n","import Modal from 'flarum/common/components/Modal';\nimport Croppie from \"croppie\";\n\nexport default class ModalWeight extends Modal {\n  static isDismissible = true;\n\n  oninit(vnode) {\n    super.oninit(vnode);\n  }\n\n  className() {\n    // Custom CSS classes to apply to the modal\n    return 'custom-modal-class';\n  }\n  onready() {\n    super.onready();\n\n    let index = this.attrs.index;\n    // 创建一个Croppie实例\n    let c = new Croppie(document.getElementById('upload-preview'), {\n      viewport: { width: 200, height: 200, type: 'square' },\n      boundary: { width: 300, height: 300 },\n      showZoomer: false,\n      enableExif: true,\n      enableOrientation: true\n    });\n\n    console.log(c);\n\n    // 选择图片按钮点击事件\n    document.getElementById('upload-button').addEventListener('click', function () {\n      document.getElementById('upload-input').click();\n    });\n\n    // 上传图片事件\n    document.getElementById('upload-input').addEventListener('change', function (e) {\n      const file = e.target.files[0];\n      const reader = new FileReader();\n\n      reader.onload = function (event) {\n        c.bind({\n          url: event.target.result\n        });\n      };\n\n      reader.readAsDataURL(file);\n\n      document.getElementById('upload-button').style.display = 'none';\n      document.getElementById('crop-button').style.display = 'block';\n    });\n\n    function base64toFile(dataurl, filename) {\n      let arr = dataurl.split(',');\n      let mime = arr[0].match(/:(.*?);/)[1];\n      let suffix = mime.split('/')[1];\n      let bstr = atob(arr[1]);\n      let n = bstr.length;\n      let u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new File([u8arr], `${filename}.${suffix}`, {\n        type: mime\n      });\n    }\n\n    // 裁剪按钮点击事件\n    document.getElementById('crop-button').addEventListener('click', function () {\n      c.result('base64').then(function (base64) {\n        // 在这里可以将base64字符串发送到服务器保存\n        const user = index.attrs.user;\n        const data = new FormData();\n        data.append('avatar', base64toFile(base64));\n\n        app\n          .request({\n            method: 'POST',\n            url: `${app.forum.attribute('apiUrl')}/users/${user.id()}/avatar`,\n            serialize: (raw) => raw,\n            body: data,\n          })\n          .then(index.success.bind(index), index.failure.bind(index)).then(() => {\n            app.modal.close()\n        });\n      });\n    });\n  }\n\n  title() {\n    return app.translator.trans('flarum-avatar-cropper.forum.modal-title');\n  }\n\n  content() {\n    // Content to show in the modal's body\n    return <div id=\"upload-container\">\n      <div id=\"upload-preview\"></div>\n      <input type=\"file\" id=\"upload-input\" style=\"display: none;\"></input>\n      <button id=\"upload-button\" className=\"Button Button--primary IndexPage-newDiscussion hasIcon\" style=\"float: right; margin-bottom: 20px; margin-right: 20px;\">选择图片</button>\n      <button id=\"crop-button\" className=\"Button Button--primary IndexPage-newDiscussion hasIcon\" style=\"display: none; float: right; margin-bottom: 20px; margin-right: 20px;\">裁剪</button>\n    </div>;\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n    // If your modal contains a form, you can add form processing logic here.\n  }\n}\n","import app from 'flarum/forum/app';\nimport { extend, override } from 'flarum/common/extend';\nimport AvatarEditor from 'flarum/forum/components/AvatarEditor';\nimport Button from 'flarum/common/components/Button';\nimport ModalWeight from \"../common/components/ModalWeight\";\n\napp.initializers.add('widayn/flarum-avatar-cropper', () => {\n  override(AvatarEditor.prototype, 'quickUpload', function (original, e){\n    if (!this.attrs.user.avatarUrl()) {\n      e.preventDefault();\n      e.stopPropagation();\n      app.modal.show(ModalWeight, {'index':this})\n    }\n  })\n\n  extend(AvatarEditor.prototype, 'controlItems', function (items) {\n    function openUpload(e) {\n      if (e.loading) return;\n\n      app.modal.show(ModalWeight, {'index':this})\n    }\n\n    items.replace(\n      'upload',\n      <Button icon=\"fas fa-upload\" onclick={openUpload.bind(this)}>\n        upload\n      </Button>\n    );\n  })\n});\n","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/AvatarEditor'];","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["root","factory","define","amd","exports","nodeName","module","Croppie","self","Promise","a","b","apply","arguments","c","TypeError","_state","_value","_deferreds","i","e","f","d","push","k","onFulfilled","onRejected","resolve","reject","then","g","call","length","h","j","setTimeout","setImmediate","l","Array","isArray","Object","prototype","toString","all","slice","constructor","race","_setImmediateFn","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event","HTMLCanvasElement","toBlob","defineProperty","value","callback","type","quality","binStr","atob","toDataURL","split","len","arr","Uint8Array","charCodeAt","Blob","cssPrefixes","emptyStyles","createElement","style","EXIF_NORM","EXIF_FLIP","CSS_TRANS_ORG","CSS_TRANSFORM","CSS_USERSELECT","vendorPrefix","prop","capProp","toUpperCase","getExifOffset","ornt","rotate","indexOf","index","offset","deepExtend","destination","source","property","clone","object","debounce","func","wait","immediate","timeout","context","args","later","callNow","clearTimeout","dispatchChange","element","initEvent","dispatchEvent","fireEvent","css","el","styles","val","tmp","addClass","classList","add","className","removeClass","remove","replace","setAttributes","attrs","key","setAttribute","num","v","parseInt","loadImage","src","doExif","img","Image","opacity","_resolve","removeAttribute","match","onload","EXIF","getData","onerror","ev","naturalImageDimensions","w","naturalWidth","naturalHeight","orient","getExifOrientation","x","width","height","TRANSLATE_OPTS","suffix","Transform","y","scale","parseFloat","parse","fromMatrix","fromString","vals","substring","values","translate","globals","TransformOrigin","exifdata","Orientation","drawCanvas","canvas","orientation","ctx","getContext","save","Math","PI","drawImage","restore","_create","contClass","customViewportClass","options","viewport","boundary","overlay","bw","bh","useCanvas","enableOrientation","_hasExif","data","elements","preview","isNaN","appendChild","customClass","_initDraggable","enableZoom","_initializeZoom","enableResize","_initializeResize","enableExif","wrap","isDragging","direction","originalX","originalY","minSize","maxWidth","maxHeight","vr","hr","resizeControls","mouseDown","button","preventDefault","overlayRect","getBoundingClientRect","pageX","pageY","currentTarget","touches","addEventListener","mouseMove","mouseUp","body","deltaX","deltaY","newHeight","newWidth","_updateOverlay","_updateZoomLimits","_updateCenterPoint","_triggerUpdate","removeEventListener","_setZoomerVal","z","zoomer","fix","max","min","zoomerWrap","step","display","showZoomer","_currentZoom","change","_onZoom","origin","viewportRect","transform","scroll","delta","targetZoom","mouseWheelZoom","ctrlKey","wheelDelta","ui","vpRect","applyCss","transCss","enforceBoundary","boundaries","_getVirtualBoundaries","transBoundaries","oBoundaries","maxX","minX","maxY","minY","_debouncedOverlay","vpWidth","vpHeight","centerFromBoundaryX","clientWidth","centerFromBoundaryY","clientHeight","imgRect","curImgWidth","curImgHeight","halfWidth","halfHeight","originMinX","originMaxX","originMinY","originMaxY","vpData","pc","top","left","center","adj","cx","cy","tx","ty","newCss","originalDistance","assignTransformCoordinates","bottom","right","toggleGrabState","keyDown","LEFT_ARROW","UP_ARROW","RIGHT_ARROW","DOWN_ARROW","shiftKey","keyCode","zoom","setZoom","enableKeyMovement","movement","parseKeyDown","keyMove","touch1","touch2","dist","sqrt","boundRect","imgData","get","_isVisible","update","$","Prototype","trigger","offsetHeight","offsetWidth","_updatePropertiesFromImage","initialZoom","cssReset","transformReset","originReset","isVisible","bound","_originalImageWidth","_originalImageHeight","points","_bindPoints","_centerImage","initial","minZoom","maxZoom","defaultInitialZoom","boundaryData","minW","minH","boundZoom","pointsWidth","vpOffset","originTop","originLeft","transformTop","transformLeft","imgDim","vpDim","boundDim","vpLeft","vpTop","_transferImageToCanvas","customOrientation","clearRect","_getCanvas","circle","startX","startY","canvasWidth","outputWidth","canvasHeight","outputHeight","backgroundColor","fillStyle","fillRect","sx","sy","sWidth","sHeight","dx","dy","dWidth","dHeight","abs","globalCompositeOperation","beginPath","arc","closePath","fill","_getHtmlResult","div","url","_getBase64Result","format","_getBlobResult","blob","_replaceImage","parentNode","forEach","replaceChild","_bind","cb","hasExif","natDim","rect","aspectRatio","imgAspectRatio","x0","y0","x1","y1","relative","map","p","decimalPoints","toFixed","_get","widthDiff","heightDiff","x2","y2","Infinity","Number","NEGATIVE_INFINITY","RESULT_DEFAULTS","RESULT_FORMATS","_result","opts","resultType","size","ratio","prom","toLowerCase","_refresh","_rotate","deg","oldHeight","oldWidth","_destroy","removeChild","jQuery","fn","croppie","ot","singleInst","result","bind","each","method","isFunction","removeData","Error","defaults","tagName","origImage","replacementDiv","bindOpts","orientationControls","enabled","leftClass","rightClass","refresh","destroy","Modal","ModalWeight","_Modal","_inheritsLoose","_proto","oninit","vnode","onready","getElementById","console","log","click","file","target","files","reader","FileReader","readAsDataURL","base64toFile","dataurl","filename","mime","bstr","n","u8arr","File","base64","user","FormData","append","app","request","forum","attribute","id","serialize","raw","success","failure","modal","close","title","translator","trans","content","m","onsubmit","isDismissible","default","extend","override","AvatarEditor","Button","initializers","original","avatarUrl","stopPropagation","show","items","openUpload","loading","icon","onclick","setPrototypeOf","subClass","superClass","create","_setPrototypeOf","o","__proto__"],"sourceRoot":""}